# TESTCASES

## 1. Общая информация

Сервис: микросервис объявлений Avito  
Host: https://qa-internship.avito.com  
Основные сущности:
- Объявление (item): имеет уникальный `itemId`, привязано к продавцу `sellerId`.
- Продавец (seller): идентификатор `sellerId` (рекомендуемый диапазон 111111–999999).
- Статистика по объявлению: агрегированные данные по просмотрам/покупкам и т.п. [conversation_history:10]

Проверяемые ручки (эндпоинты):
1. Создать объявление.
2. Получить объявление по `itemId`.
3. Получить все объявления по `sellerId`.
4. Получить статистику по `itemId`. [conversation_history:10]

---

## 2. Принятые обозначения

- `<BASE_URL>` = `https://qa-internship.avito.com`
- Все ID, создаваемые в тестах, должны быть уникальными в рамках запуска (особенно `sellerId` из диапазона `111111–999999`). [conversation_history:10]
- Формат тест‑кейса:
    - ID
    - Название
    - Предусловия
    - Шаги
    - Ожидаемый результат

---

## 3. Тесты для создания объявления (CREATE)

### TC_CREATE_001 — Успешное создание объявления с валидными данными

**Предусловия:**
- Есть уникальный `sellerId` в диапазоне `111111–999999`, ранее не использованный в тестах, например `123456`. [conversation_history:10]

**Шаги:**
1. Отправить `POST <BASE_URL>/ads` с JSON‑телом:
   {
   "sellerId": 123456,
   "title": "Test ad title",
   "description": "Test ad description",
   "price": 1000
   }

2. Зафиксировать тело ответа и статус‑код.

**Ожидаемый результат:**
- Статус‑код `201 Created`.
- В теле ответа:
- присутствует поле `itemId` (уникальное, не пустое);
- поля `sellerId`, `title`, `description`, `price` совпадают с отправленными;
- при повторном создании с тем же `sellerId` и другими полями создаётся новое объявление с другим `itemId`. [conversation_history:10]

---

### TC_CREATE_002 — Обязательные поля: отсутствие title

**Предусловия:**
- Уникальный `sellerId` в диапазоне 111111–999999.

**Шаги:**
1. `POST <BASE_URL>/ads` с телом:
   {
   "sellerId": 123457,
   "description": "No title",
   "price": 1000
   }

**Ожидаемый результат:**
- Если `title` обязателен по спецификации: статус‑код `400 Bad Request`, описание ошибки о некорректном запросе / отсутствии `title`.
- Если `title` не обязателен: статус‑код `201`, в созданном объекте `title` пустой/отсутствует, поведение зафиксировать в BUGS/README. [conversation_history:10]

---

### TC_CREATE_003 — Негативный: некорректный sellerId (меньше диапазона)

**Предусловия:**
- `sellerId` = `100000` (ниже рекомендованного диапазона 111111–999999). [conversation_history:10]

**Шаги:**
1. `POST <BASE_URL>/ads`:
   {
   "sellerId": 100000,
   "title": "Bad seller",
   "description": "Invalid sellerId",
   "price": 1000
   }

**Ожидаемый результат:**
- Ожидаемое корректное поведение: статус‑код `400` либо валидационная ошибка по `sellerId`.
- Если сервис принимает такое значение и создаёт объявление — это потенциальный дефект (описать в `BUGS.md`). [conversation_history:10]

---

### TC_CREATE_004 — Негативный: sellerId не число

**Шаги:**
1. `POST <BASE_URL>/ads`:
   {
   "sellerId": "abc",
   "title": "Invalid seller type",
   "description": "sellerId is string",
   "price": 1000
   }

**Ожидаемый результат:**
- Статус‑код `400 Bad Request`.
- Тело ответа содержит информацию о типовой ошибке (несоответствие типов/невалидный формат). [conversation_history:10]

---

### TC_CREATE_005 — Негативный: отрицательная или нулевая цена

**Шаги:**
1. `POST <BASE_URL>/ads`:
   {
   "sellerId": 123458,
   "title": "Invalid price",
   "description": "price -1",
   "price": -1
   }

2. Повторить для `price = 0` (либо вынести в отдельный тест, если логика разная).

**Ожидаемый результат:**
- Если по бизнес‑логике цена должна быть > 0:
- статус‑код `400`;
- сообщение о некорректной цене.
- Если объявление создаётся — зафиксировать фактическое поведение. [conversation_history:10]

---

### TC_CREATE_006 — Граничные значения длины title

**Шаги:**
1. Подготовить title минимально допустимой длины (например, 1 символ) и максимально допустимой длины (значение взять из `swagger.yaml`, если там есть ограничения). [web:11]
2. Для каждого варианта отправить `POST <BASE_URL>/ads` с валидным `sellerId` и `price`.

**Ожидаемый результат:**
- Для допустимых длины title создаётся объявление со статусом `201`.
- Для превышающих лимит — ожидается `400` или другая валидационная ошибка. [web:11]

---

## 4. Тесты для получения объявления по itemId (GET /ads/{itemId})

### TC_GET_001 — Успешное получение существующего объявления

**Предусловия:**
- Создано объявление через `POST /ads`, получен валидный `itemId` (например, в TC_CREATE_001). [conversation_history:10]

**Шаги:**
1. Выполнить `GET <BASE_URL>/ads/{itemId}`.
2. Зафиксировать статус‑код и тело.

**Ожидаемый результат:**
- Статус‑код `200 OK`.
- В теле:
- `itemId` совпадает с запрошенным;
- `sellerId`, `title`, `description`, `price` соответствуют данным при создании. [conversation_history:10]

---

### TC_GET_002 — Запрос несуществующего itemId

**Предусловия:**
- Используется заведомо несуществующий `itemId`, например `999999999999` (формат/тип соответствует спецификации, но объект не создавался). [web:11]

**Шаги:**
1. `GET <BASE_URL>/ads/999999999999`.

**Ожидаемый результат:**
- Статус‑код `404 Not Found`.
- Тело содержит информацию, что объявление не найдено. [conversation_history:10]

---

### TC_GET_003 — Невалидный формат itemId (строка вместо числа)

**Шаги:**
1. `GET <BASE_URL>/ads/abc`.

**Ожидаемый результат:**
- Статус‑код `400 Bad Request` или иной код валидации.
- Сообщение об ошибке формата идентификатора. [conversation_history:10]

---

### TC_GET_004 — Проверка idempotency (повторные запросы)

**Предусловия:**
- Есть существующий `itemId`.

**Шаги:**
1. Выполнить 3 раза подряд `GET <BASE_URL>/ads/{itemId}`.
2. Сравнить ответы.

**Ожидаемый результат:**
- Все три ответа имеют статус‑код `200`.
- Тела идентичны, данные объявления не изменяются. [conversation_history:10]

---

## 5. Тесты для получения всех объявлений по sellerId (GET /seller/{sellerId}/ads или аналогичная ручка)

### TC_GET_SELLER_001 — Несколько объявлений одного продавца

**Предусловия:**
- Для одного `sellerId` (например, `234567`) создано минимум 2 объявления через `POST /ads`. [conversation_history:10]

**Шаги:**
1. `GET <BASE_URL>/seller/234567/ads` (путь уточнить по swagger). [web:11]
2. Зафиксировать статус‑код и тело.

**Ожидаемый результат:**
- Статус‑код `200 OK`.
- В ответе массив объявлений:
- размер массива >= 2;
- у всех элементов `sellerId` = 234567;
- поля объявлений соответствуют ранее созданным. [conversation_history:10]

---

### TC_GET_SELLER_002 — Продавец без объявлений

**Предусловия:**
- `sellerId`, для которого не создавалось ни одного объявления (например, 987654). [conversation_history:10]

**Шаги:**
1. `GET <BASE_URL>/seller/987654/ads`.

**Ожидаемый результат:**
- Статус‑код `200 OK`.
- Возвращается пустой массив (или явно указано отсутствие объявлений); не должно быть ошибки. [conversation_history:10]

---

### TC_GET_SELLER_003 — Невалидный формат sellerId (строка)

**Шаги:**
1. `GET <BASE_URL>/seller/abc/ads`.

**Ожидаемый результат:**
- Статус‑код `400 Bad Request`.
- Описание ошибки по формату `sellerId`. [conversation_history:10]

---

### TC_GET_SELLER_004 — Граничные значения sellerId

**Шаги:**
1. Выполнить запросы:
- `GET <BASE_URL>/seller/111111/ads` (нижняя граница диапазона).
- `GET <BASE_URL>/seller/999999/ads` (верхняя граница диапазона).
2. Для теста можно при необходимости предварительно создать объявления с такими `sellerId`. [conversation_history:10]

**Ожидаемый результат:**
- Сервис корректно принимает крайние значения.
- Если объявления созданы — возвращает их, если нет — пустой массив с `200`. [conversation_history:10]

---

## 6. Тесты для получения статистики по itemId (GET /stats/{itemId} или аналог)

### TC_STATS_001 — Успешное получение статистики для существующего объявления

**Предусловия:**
- Есть созданное объявление с `itemId`.
- В системе должна быть возможность формирования статистики по этому объявлению (поведение уточняется по swagger/postman). [web:11]

**Шаги:**
1. `GET <BASE_URL>/stats/{itemId}`.
2. Зафиксировать статус‑код и тело.

**Ожидаемый результат:**
- Статус‑код `200 OK`.
- В ответе присутствуют поля статистики (например, `views`, `contacts`, `favorites` — конкретные поля взять из Swagger). [web:11]
- Форматы и типы полей соответствуют спецификации (обычно целые числа ≥ 0). [web:11]

---

### TC_STATS_002 — Статистика для несуществующего itemId

**Шаги:**
1. `GET <BASE_URL>/stats/999999999999`.

**Ожидаемый результат:**
- Либо `404 Not Found` (статистика не существует),
- Либо `200` с "нулевой" статистикой (все значения = 0) — фактическое поведение зафиксировать и при необходимости описать как баг/особенность. [conversation_history:10]

---

### TC_STATS_003 — Невалидный формат itemId

**Шаги:**
1. `GET <BASE_URL>/stats/abc`.

**Ожидаемый результат:**
- Статус‑код `400 Bad Request`.
- Сообщение о некорректном формате идентификатора. [conversation_history:10]

---

### TC_STATS_004 — Консистентность статистики при повторном запросе

**Предусловия:**
- Есть объявление с некоторой статистикой (если статистика увеличивается при просмотрах, нужно заранее понять это поведение по спецификации/экспериментам). [web:11]

**Шаги:**
1. Выполнить 2 последовательных запроса `GET /stats/{itemId}`.
2. Сравнить ответы.

**Ожидаемый результат:**
- Если статистика не должна меняться между запросами — значения совпадают.
- Если статистика изменяется (например, счётчик просмотров растёт) — поведение зафиксировать и проверить, что изменение детерминированное и соответствует требованиям. [conversation_history:10]

---

## 7. Нефункциональные и кросс‑ручковые тесты

### TC_CROSS_001 — Целостность данных: create → get → seller → stats

**Шаги:**
1. Создать объявление `POST /ads` (получить `itemId`, `sellerId`).
2. Получить объявление по `GET /ads/{itemId}`.
3. Получить все объявления по `GET /seller/{sellerId}/ads`.
4. Получить статистику по `GET /stats/{itemId}`.

**Ожидаемый результат:**
- Во всех ответах `itemId` и `sellerId` согласованы между собой.
- Объявление присутствует в списке по `sellerId`.
- Статистика возвращается для этого `itemId` без ошибок. [conversation_history:10]

---

### TC_NONFUNC_001 — Базовая проверка времени ответа

**Шаги:**
1. Выполнить по одному запросу ко всем 4 ручкам (`create`, `get by id`, `get by seller`, `stats`) с валидными данными.
2. Замерить время ответа (например, средствами тест‑фреймворка/Rest client).

**Ожидаемый результат:**
- Время ответа укладывается в приемлемый предел (например, < 1 секунды для единичного запроса; фактический порог указать в README как наблюдение). [web:11]

---

